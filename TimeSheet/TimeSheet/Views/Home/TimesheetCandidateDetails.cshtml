@model  TimeSheet.Models.TimeSheetViewModel



<div>
    <div class="modal-header" style="background-color:lightgray;width:1229px">
        <h5 class="modal-title text-center">Resource Details</h5>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
    </div>
    <div style="align-content:center;padding-top:15px;padding-bottom:40px;padding-left:20px;width:1200px">
        <table id="tblCustomers" class="table-bordered table-responsive-md text-center table-hover table-scroll" style="align-content:center;padding-top:15px;padding-bottom:10px;width:1200px">
            <thead style="background-color:#FFA500;color:white">
                <tr>
                    <th>Id</th>
                    <th>CandidateName</th>
                    <th>Activity</th>
                    <th style="width:50px">BookDate </th>
                    <th>StartTime</th>
                    <th>EndTime</th>
                    <th style="width:10px">OLA</th>
                    <th style="width:10px">Actual</th>
                    <th>Status</th>
                    <th style="width:10px">Comments</th>
                    <th style="width:10px"></th>
                </tr>
            </thead>
            <tbody class="table">
                @foreach (var item in Model.CandidateTimeSheetList)
                {
                    <tr>
                        <td class="Id"> <span>@item.Id</span> </td>

                        <td class="CandidateName">
                            @Html.DisplayFor(modelItem => item.CandidateName)
                        </td>
                        <td class="Activity">
                            @Html.DisplayFor(modelItem => item.Activity)
                        </td>
                        <td width="7%">
                            @Html.DisplayFor(modelItem => item.Day)
                        </td>

                        <td class="StartTime">
                            <span>@item.StartTime.Value.ToShortTimeString()</span>
                            <input type="time" id="startTime" value="@item.StartTime.Value.ToString("HH:mm")" style="display:none" />
                        </td>

                        <td class="EndTime">
                            <span>@item.EndTime.Value.ToShortTimeString()</span>
                            <input type="time" id="endTime" value="@item.EndTime.Value.ToString("HH:mm")" style="display:none" />
                        </td>

                        <td class="OLATarget">
                            @Html.DisplayFor(modelItem => item.OLATarget)
                        </td>
                        <td class="ActualQuantity">
                            <span style="width:2px">@item.ActualQuantity</span>
                            <input type="text" value="@item.ActualQuantity" style="display:none;width:30px" />
                        </td>
                        <td class="Status">
                            <span text="Status" span />
                            @Html.DropDownListFor(model => item.StatusID, Model.StatusList, "Select Status")
                        </td>
                        <td class="TimeSheetComments">
                            <span>@item.TimeSheetComments</span>
                            <input type="text" value="@item.TimeSheetComments" style="display:none" />
                        </td>
                        <td width="5%">
                            <a class="Edit" href="javascript:;">Edit</a>
                            <a class="Update" href="javascript:;" style="display:none" id="Update">Update</a>
                            <a class="Cancel" href="javascript:;" style="display:none">Cancel</a>
                            @*<a class="Delete" href="javascript:;">Delete</a>*@
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
    //$(function () {
    //    //Remove the dummy row if data present.
    //    if ($("#tblCustomers tr").length > 2) {
    //        $("#tblCustomers tr:eq(1)").remove();
    //    } else {
    //        var row = $("#tblCustomers tr:last-child");
    //        row.find(".Edit").hide();
    //        row.find("span").html('&nbsp;');
    //    }
    //});

    //$(document).ready(function () {
    //    $('tr').click("click", "#tblCustomers .Edit", function () {
    //        var row = $(this).closest("tr");
    //        $("td", row).each(function () {
    //        if (this.style.background == "" || this.style.background == "white") {
    //            $(this).css('background', 'red');
    //        }
    //        else {
    //            $(this).css('background', 'white');
    //        }
    //    });
    //    });
    //});

    function AppendRow(row, Id, OLATarget, ActualQuantity, TimeSheetComments, StartTime, EndTime) {
        //Bind CustomerId.
        $(".Id", row).find("span").html(Id);

        //Bind Name.
        $(".OLATarget", row).find("span").html(OLATarget);
        $(".OLATarget", row).find("input").val(OLATarget);

        //Bind Country.
        $(".ActualQuantity", row).find("span").html(ActualQuantity);
        $(".ActualQuantity", row).find("input").val(ActualQuantity);

        //Bind Name.
        $(".TimeSheetComments", row).find("span").html(TimeSheetComments);
        $(".TimeSheetComments", row).find("input").val(TimeSheetComments);

        //Bind Country.
        $(".StartTime", row).find("span").html(StartTime);
        $(".StartTime", row).find("input").val(StartTime);

        //Bind Name.
        $(".EndTime", row).find("span").html(EndTime);
        $(".EndTime", row).find("input").val(EndTime);



        row.find(".Edit").show();
        row.find(".Delete").show();
        $("#tblCustomers").append(row);
    };

    //Edit event handler.
    $("body").on("click", "#tblCustomers .Edit", function () {
        // debugger;
        var row = $(this).closest("tr");
        $("td", row).each(function () {
            if ($(this).find("input").length > 0) {
                $(this).find("input").show();
                $(this).find("span").hide();
                $(this).toggleClass('selected');

            }
        });

        row.find(".Update").show();
        row.find(".Cancel").show();

        $(this).hide();
    });

    //Update event handler.
    $("body").on("click", "#tblCustomers .Update", function () {
        debugger;
        var row = $(this).closest("tr");
        $("td", row).each(function () {
            if ($(this).find("input").length > 0) {
                var span = $(this).find("span");
                var input = $(this).find("input");
                span.html(input.val());
                span.show();
                input.hide();
                $(this).removeClass('selected');
            }
        });
        row.find(".Edit").show();
        row.find(".Cancel").hide();
        $(this).hide();

        var CandidateEdit = {};
        debugger;
        CandidateEdit.Id = row.find(".Id").find("span").html();
        CandidateEdit.ActualQuantity = row.find(".ActualQuantity").find("span").html();
        CandidateEdit.TimeSheetComments = row.find(".TimeSheetComments").find("span").html();
        CandidateEdit.StartTime = row.find(".StartTime").find("span").html();
        CandidateEdit.EndTime = row.find(".EndTime").find("span").html();
        $.ajax({
            type: "POST",
            url: "./UpdateCandidate",
            data: '{CandidateEdit:' + JSON.stringify(CandidateEdit) + '}',
            contentType: "application/json; charset=utf-8",
            dataType: "json"
        });
    });





    //Cancel event handler.
    $("body").on("click", "#tblCustomers .Cancel", function () {
        var row = $(this).closest("tr");
        $("td", row).each(function () {
            if ($(this).find("input").length > 0) {
                var span = $(this).find("span");
                var input = $(this).find("input");
                $(this).removeClass('selected');
                input.val(span.html());
                span.show();
                input.hide();
            }
        });
        row.find(".Edit").show();
        row.find(".Update").hide();
        $(this).hide();
    });

</script>
<style>
    .modal-dialog {
        width: 1250px;
        margin: 30px auto;
        margin-bottom:10px;
    }

    .table-hover > tbody > tr:hover > td,
    .table-hover > tbody > tr:hover > th {
        background-color: lightgray;
    }

    .selected {
        color: black;
        background-color: lightgray;
    }

    .btn {
        font-size: 10px;
    }

    table tr.active {
        background: red;
    }
</style>